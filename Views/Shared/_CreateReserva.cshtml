@model Reserva_de_equipos.Models.Reserva

@{
    var isEdit = Model != null && Model.ReservaId > 0;
}

<div class="modal fade" id="crearReservaModal" tabindex="-1" aria-labelledby="crearReservaModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header border-2 py-4 pb-1">
                <h3 class="h3" id="crearReservaModalLabel">Reserva de equipos</h3>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
            </div>

            <div class="modal-body">
                <form 
                    asp-controller="Reservas" 
                    asp-action="@(isEdit ? "Edit" : "Create")"
                    asp-route-id = "@(isEdit ? Model.ReservaId : null)"
                    method="post" 
                    novalidate class="modal-form p-3"
                >
                    @Html.AntiForgeryToken()
                    @if (isEdit)
                    {
                        <input type="hidden" asp-for="ReservaId" />
                    }
                    <div asp-validation-summary="ModelOnly" class="text-danger mb-2"></div>
                    <div class="row align-items-center g-2 mb-3">
                        <div class="col-12 col-sm-4 text-sm-start">
                            <label asp-for="EquipoId" class="col-form-label fw-semibold"></label>
                        </div>
                        <div class="col-12 col-sm-8">
                            <select asp-for="EquipoId" class="form-select" asp-items="ViewBag.Equipos">
                                <option value="">Seleccione un equipo</option>
                            </select>
                            <span asp-validation-for="EquipoId" class="text-danger small"></span>
                        </div>
                    </div>
                    <div class="row align-items-center g-2 mb-3">
                        <div class="col-12 col-sm-4 text-sm-start">
                            <label asp-for="Ubicación" class="col-form-label fw-semibold"></label>
                        </div>
                        <div class="col-12 col-sm-8">
                            <input asp-for="Ubicación" class="form-control" placeholder="Room B ..." autocomplete="off" />
                            <span asp-validation-for="Ubicación" class="text-danger small"></span>
                        </div>
                    </div>
                    <div class="row align-items-center g-2 mb-3">
                        <div class="col-12 col-sm-4 text-sm-start">
                            <label asp-for="FechaInicio" class="col-form-label fw-semibold"></label>
                        </div>
                        <div class="col-12 col-sm-8">
                            <input asp-for="FechaInicio" type="datetime-local" class="form-control" />
                            <span asp-validation-for="FechaInicio" class="text-danger small"></span>
                        </div>
                    </div>
                    <div class="row align-items-center g-2 mb-3">
                        <div class="col-12">
                            <div class="alert alert-info d-flex align-items-center py-2 px-3 mb-0" role="alert"
                                 style="border-left: 5px solid #0dcaf0; background-color: #e8f8fc;">
                                <iconify-icon icon="material-symbols:info-outline" class="me-2" style="font-size: 1.3rem;"></iconify-icon>
                                <span class="text-justify">
                                    <strong>Nota:</strong> Estimado usuario, su reserva no tendrá una <b>Fecha de Fin</b> establecida si marca la casilla <em>“Indefinido”</em>.
                                </span>
                            </div>
                        </div>
                    </div>
                    <div class="row align-items-center g-2 mb-3">
                        <div class="col-12 col-sm-4 text-sm-start">
                            <label asp-for="FechaFin" class="col-form-label fw-semibold"></label>
                        </div>
                        <div class="col-12 col-sm-5">
                            <input asp-for="FechaFin" type="datetime-local" class="form-control" id="FechaFin" />
                            <span asp-validation-for="FechaFin" class="text-danger small"></span>
                        </div>
                        <div class="col-12 col-sm-3">
                            <div class="form-check mt-2">
                                <input asp-for="Indefinido" class="form-check-input" id="Indefinido" onclick="toggleFechaFin()" />
                                <label asp-for="Indefinido" class="form-check-label">Indefinido</label>
                            </div>
                        </div>
                        <script>
                            function toggleFechaFin() {
                                const check = document.getElementById('Indefinido');
                                const fechaFin = document.getElementById('FechaFin');
                                if (check.checked) {
                                    fechaFin.value = '';      
                                    fechaFin.disabled = true; 
                                } else {
                                    fechaFin.disabled = false;
                                }
                            }
                        </script>
                    </div>
                    <div class="row g-2 mb-3">
                        <div class="col-12 col-sm-4 text-sm-start">
                            <label asp-for="Descripcion" class="col-form-label fw-semibold">Notas</label>
                        </div>
                        <div class="col-12 col-sm-8">
                            <textarea asp-for="Descripcion" class="form-control" rows="3" placeholder="Detalles de la reserva..."></textarea>
                            <span asp-validation-for="Descripcion" class="text-danger small"></span>
                        </div>
                    </div>
                    <div class="d-flex justify-content-end gap-2 pt-2">
                        <button type="submit" class="btn btn-primary px-4">Guardar</button>
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <partial name="_ValidationScriptsPartial" />
}